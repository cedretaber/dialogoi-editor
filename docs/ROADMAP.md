# Dialogoi Editor ロードマップ

## 開発フェーズ

### 🚀 Phase 1: MVP (Minimum Viable Product) ✅ **完了**
**目標**: 基本的なファイル管理機能を持つExtensionの実装

**実装完了**:
- [x] VSCode Extension の基本構造とTreeView実装
- [x] `meta.yaml` の読み書き機能
- [x] ファイルの作成・削除・並び替え・名前変更
- [x] ディレクトリクリックでREADME.md表示
- [x] 自動拡張子付与とアイコン表示
- [x] 包括的なテストスイート

### 📝 Phase 2: メタデータ管理強化 ✅ **完了**
**目標**: 小説執筆に必要なメタデータ管理機能の充実

**実装完了**:
- [x] タグシステム（ファイル・ディレクトリへのタグ付与、TreeView表示）
- [x] 参照関係管理（双方向管理、ツールチップ表示、存在チェック）
- [x] ファイルハッシュによる変更検知システム
- [x] レビュー機能（追加・編集・削除、ステータス管理、スレッド機能）
- [x] キャラクター設定・用語集・伏線管理機能
- [x] `dialogoi.yaml` の仕様策定と実装
- [x] 小説プロジェクト新規作成機能（既存ディレクトリスキャン、自動判定）

### 🔧 Phase 2.5: アーキテクチャリファクタリング ✅ **完了**
**目標**: Repository/Service層の設計問題を解決し、適切な責務分離を実装

**実装完了**:
- [x] MetaYamlService・FileOperationService の新規実装（依存関係注入パターン）
- [x] Repository から高レベルメソッドを削除、純粋なデータアクセス層に特化
- [x] Service層でのビジネスロジック処理に集約
- [x] 循環依存の解消とテスト可能性の向上

### 🛠️ Phase 2.8: コードベースリファクタリング ✅ **完了**
**目標**: Phase 3 進出前の大規模リファクタリングでコード品質を最大化

**実装完了**:
- [x] ESLint設定修正とany型の完全排除（120個のエラー→0個）
- [x] extension.tsの分割（446行→71行、84%削減）
- [x] Logger クラス実装による統一されたエラーハンドリング
- [x] 未使用コード削除とコードクリーンアップ
- [x] 命名規則の統一と不要コメントの削除

**成果**:
- ✅ TypeScript 型安全性の完全確保
- ✅ 保守性の高いモジュール構成（/commands構造）
- ✅ 一貫したエラーハンドリング
- ✅ 182個のテストが全て成功

### 🎨 Phase 3: UI/UX改善 ✅ **完了**
**目標**: より使いやすいインターフェースの提供

#### Phase 3.1: WebView統合UI ✅ **完了**
- [x] Activity BarにDialogoi ViewContainerを追加
- [x] TreeView（ファイルツリー）とWebView（ファイル詳細）の統合
- [x] VSCodeエクスプローラー風の折りたたみ可能セクション
- [x] TreeView選択時のリアルタイム詳細表示更新
- [x] ワークフロー改善（エクスプローラー⇔詳細パネルの行き来が不要）

#### Phase 3.2a: タグ編集機能改善 ✅ **完了**
- [x] インラインタグ編集UI
- [x] Enterキーによる高速タグ追加
- [x] 個別タグ削除ボタン
- [x] TreeViewとWebViewのリアルタイム同期

#### Phase 3.2c: 検索・フィルタリング機能 ✅ **完了**
- [x] タグによるリアルタイムフィルタリング
- [x] 深い階層対応の再帰的フィルタリング
- [x] フィルター/クリアボタンをTreeViewタイトルバーに統合
- [x] VSCode設定統合（files.excludeでDialogoiファイルを検索除外）
- [x] Activity Barカスタムアイコン（本型SVGアイコン）

#### Phase 3.3a: 新規プロジェクト作成ボタン ✅ **完了**
- [x] ウェルカム画面の実装（プロジェクト未検出時の案内表示）
- [x] 「新しい小説を開始」ボタン（dialogoi.startNewNovelコマンド）
- [x] プロジェクト作成入力フォーム（タイトル・著者・タグ）
- [x] プロジェクト設定編集コマンド（dialogoi.editProjectSettingsコマンド）
- [x] 既存ProjectCreationServiceのUI化
- [x] Activity Bar表示の改善（空ディレクトリでもアイコン表示）
- [x] ファイル作成時のサブタイプ対応（キャラクター・伏線・用語集）
- [x] ファイル種別の適切な拡張子割り当て（本文=.txt、設定=.md）
- [x] 命名規則の厳格化（絶対パス/相対パス変数名の明確化）

### 🎯 Phase 3.3b: 拡張ドラッグ&ドロップ機能 ✅ **完了**
- [x] ドラッグ&ドロップでの並び替え改善
- [x] 異なるディレクトリへのファイル移動機能
- [x] ディレクトリの並び替え機能
- [x] ディレクトリの階層移動機能（循環参照検出付き）
- [x] ディレクトリの削除機能（確認ダイアログ・再帰削除対応）
- [x] 操作種別確認ダイアログ（並び替え/移動の判定）
- [x] メタデータ整合性保持とロールバック機能
### 🎯 Phase 3.4: ハイパーリンク統合機能 ✅ **完了**
- [x] ハイパーリンク自動抽出システムの実装
- [x] ReferenceManagerへの統合（手動参照とハイパーリンク参照の統一管理）
- [x] リアルタイム更新機能（ファイル保存時の自動更新）
- [x] UI改善（🔗アイコンによる視覚的区別）
- [x] WebViewアーキテクチャ問題の調査と改善案作成

### 🎯 Phase 3.5: 残りのUI改善（未着手）
- [ ] プロジェクト設定の視覚的編集画面（YAML直接編集の代替）
- [ ] 伏線設定の複数「張る」位置対応（スキーマ拡張）
- [ ] ファイル新規作成・名前変更のインライン編集
- [ ] レビュー用 UI の整備
- [ ] TODO機能の追加（レビュー機能との統合検討）
- [ ] 管理対象外ファイルの可視化改善
- [ ] コンテキストメニューの充実
- [ ] キーボードショートカットの実装
- [ ] 多言語対応（日本語優先）
- [ ] FileDetailsViewProvider.ts のリファクタリング
  - ロジックは可能な限り services/ のクラスに入れ、 Service を呼び出すこととエラーをキャッチしてエラーメッセージを表示することに特化させる
  - Service に移動させたロジックにはテストを書く

### 🔍 Phase 4: 高度な分析機能
**目標**: 執筆支援のための分析・可視化機能

- [ ] 伏線の可視化（タイムライン表示）
- [ ] キャラクター相関図
- [ ] 話数ごとの登場人物追跡
- [ ] 参照関係のグラフ表示
- [ ] 執筆統計（文字数、更新頻度等）

## 将来的な機能拡張

### 📖 執筆支援機能

1. **プレビュー機能**
   - 青空文庫形式の解釈
   - 縦書き表示対応
   - リアルタイムプレビュー

2. **PDF出力機能**
   - 印刷用レイアウト
   - 電子書籍形式への変換
   - カスタムスタイルシート対応

3. **タイムライン機能**
   - 作品内時系列の可視化
   - 矛盾検出機能
   - 読者視点での伏線タイムライン

4. **バージョン管理連携**
   - Git統合の強化
   - 変更履歴の可視化
   - 共同執筆サポート

### 🤖 AI連携機能

1. **Dialogoi MCP サーバ連携**
   - キャラクター設定に基づく対話生成
   - 設定の一貫性チェック
   - プロット提案機能

2. **執筆アシスタント**
   - 文章校正機能
   - 類語・表現提案
   - スタイル統一チェック

### 📊 分析・管理機能

1. **プロジェクト管理**
   - 執筆スケジュール管理
   - 進捗トラッキング
   - 目標設定機能

2. **テンプレート機能**
   - プロジェクトテンプレート
   - キャラクターシートテンプレート
   - ジャンル別構成テンプレート

3. **エクスポート/インポート**
   - 他の執筆ツールとの連携
   - バックアップ機能
   - クラウド同期

### 🤝 コラボレーション機能

1. **レビュー管理システム** *(Phase 2b で基本機能実装済み)*
   - [x] 編集者からのフィードバック管理
   - [x] レビューの位置追跡とハッシュによる変更検知
   - [x] スレッド形式での議論機能
   - [x] ステータス管理（open/in_progress/resolved/dismissed）
   - [ ] AIレビューの統合（Dialogoi MCP連携）

2. **共同執筆サポート**
   - 複数人での同時編集対応
   - 変更履歴の可視化
   - コンフリクト解決支援

## 技術的改善

### パフォーマンス最適化
- 大規模プロジェクト対応（1000話以上）
- インクリメンタル更新
- 遅延読み込み

### 品質向上
- 自動テストの充実
- エラーハンドリング改善
- ユーザビリティテスト

### 拡張性
- プラグインシステム
- カスタムメタデータ対応
- API公開

## コミュニティ機能（長期構想）

- 作品共有プラットフォーム
- 執筆テクニック共有
- ユーザーフォーラム
- 公式テンプレート配布

---

**注**: このロードマップは現時点での構想であり、ユーザーフィードバックや技術的制約により変更される可能性があります。